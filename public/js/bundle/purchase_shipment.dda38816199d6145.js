"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2943],{52786:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var i=a(5947),s=a.n(i);const r={metaInfo:{title:"Shipment"},data:function(){return{isLoading:!0,SubmitProcessing:!1,purchases:[],serverParams:{columnFilters:{},sort:{field:"id",type:"desc"},page:1,perPage:10},totalRows:"",search:"",limit:"10",purchase_shiments:[],purchase_shiments_base:[],editmode:!1,show_status:!0,shipment:{id:"",order_number:"",description:"",expected_arrival_at:"",date:"",status:"pending",shipping_company_name:"",purchase_id:""}}},computed:{canSelectPurchase:function(){return"pending"==this.shipment.status},columns:function(){return[{label:this.$t("OrderNumber"),field:"order_number",tdClass:"text-left",thClass:"text-left"},{label:this.$t("TrackingNumber"),field:"tracking_number",tdClass:"text-left",thClass:"text-left"},{label:"Purchase Ref",field:"purchase.Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("ExpectedArrival"),field:"expected_arrival_at",tdClass:"text-left",thClass:"text-left"},{label:this.$t("ShippingCompanyName"),field:"shipping_company_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"status",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},methods:{updateParams:function(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange:function(e){var t=e.currentPage;this.serverParams.page!==t&&(this.updateParams({page:t}),this.Get_Shipments(t))},onPerPageChange:function(e){var t=e.currentPerPage;this.limit!==t&&(this.limit=t,this.updateParams({page:1,perPage:t}),this.Get_Shipments(1))},onSortChange:function(e){this.updateParams({sort:{type:e[0].type,field:e[0].field}}),this.Get_Shipments(this.serverParams.page)},onSearch:function(e){this.search=e.searchTerm,this.Get_Shipments(this.serverParams.page)},getValidationState:function(e){var t=e.dirty,a=e.validated,i=e.valid;return t||a?void 0===i?null:i:null},Submit_Shipment:function(){var e=this;this.$refs.Create_Shipment.validate().then((function(t){t?e.editmode?e.Update_Shipment():e.Create_Shipment():e.makeToast("danger",e.$t("Please_fill_the_form_correctly"),e.$t("Failed"))})).catch((function(e){console.error("Error during validation:",e)}))},makeToast:function(e,t,a){this.$root.$bvToast.toast(t,{title:a,variant:e,solid:!0})},New_Shipment:function(){this.reset_Form(),this.$bvModal.show("New_Shipment")},Edit_Shipment:function(e){this.Get_Shipments(this.serverParams.page),this.reset_Form(),this.shipment=e,""==this.shipment.expected_arrival_at||(this.show_status=!0),this.editmode=!0,this.$bvModal.show("New_Shipment")},Selected_Base_Shipment:function(e){null==e||(this.show_status=!0)},Get_Shipments:function(e){var t=this;s().start(),s().set(.1),axios.get("purchase_shiments?page="+e+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((function(e){var a;t.purchase_shiments=null!==(a=e.data.Shipments)&&void 0!==a?a:e.data.Shipment,t.totalRows=e.data.totalRows,t.purchase_shiments_base=e.data.Shipments_base,s().done(),t.isLoading=!1})).catch((function(e){s().done(),setTimeout((function(){t.isLoading=!1}),500)}))},setToStrings:function(){null===this.shipment.expected_arrival_at&&(this.shipment.expected_arrival_at="")},Create_Shipment:function(){var e=this;this.SubmitProcessing=!0,this.setToStrings(),axios.post("purchase_shiments",{order_number:this.shipment.order_number,tracking_number:this.shipment.tracking_number,tracking_url:this.shipment.tracking_url,description:this.shipment.description,date:this.shipment.date,expected_arrival_at:this.shipment.expected_arrival_at,status:this.shipment.status,shipping_company_name:this.shipment.shipping_company_name,purchase_id:this.shipment.purchase_id}).then((function(t){e.SubmitProcessing=!1,Fire.$emit("Event_Shipment"),e.makeToast("success",e.$t("Create.OrderNumberShipment"),e.$t("Success"))})).catch((function(t){e.SubmitProcessing=!1,e.makeToast("danger",e.$t("InvalidData"),e.$t("Failed"))}))},Update_Shipment:function(){var e=this;this.SubmitProcessing=!0,this.setToStrings(),axios.put("purchase_shiments/"+this.shipment.id,{order_number:this.shipment.order_number,tracking_number:this.shipment.tracking_number,tracking_url:this.shipment.tracking_url,description:this.shipment.description,expected_arrival_at:this.shipment.expected_arrival_at,date:this.shipment.date,status:this.shipment.status,shipping_company_name:this.shipment.shipping_company_name,purchase_id:this.shipment.purchase_id}).then((function(t){e.SubmitProcessing=!1,Fire.$emit("Event_Shipment"),e.makeToast("success",e.$t("Update.OrderNumberShipment"),e.$t("Success"))})).catch((function(t){e.SubmitProcessing=!1,e.makeToast("danger",e.$t("InvalidData"),e.$t("Failed"))}))},reset_Form:function(){this.shipment={id:"",order_number:"",description:"",expected_arrival_at:"",date:"",status:"pending",shipping_company_name:"",purchase_id:""}},Remove_Shipment:function(e){var t=this;this.$swal({order_number:this.$t("Delete.OrderNumber"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((function(a){a.value&&axios.delete("purchase_shiments/"+e).then((function(e){e.data.success?t.$swal(t.$t("Delete.Deleted"),t.$t("Delete.ShipmentDeleted"),"success"):t.$swal(t.$t("Delete.Failed"),t.$t("Shipment_already_linked_with_sub_shipment"),"warning"),Fire.$emit("Delete_Shipment")})).catch((function(){t.$swal(t.$t("Delete.Failed"),t.$t("Delete.Therewassomethingwronge"),"warning")}))}))},fetchPurchases:function(){var e=this;this.loading=!0,axios.get("/purchases?status=pending&page=1&SortField=id&SortType=desc&search=&limit=10").then((function(t){var a,i;e.purchases=null!==(a=null===(i=t.data)||void 0===i?void 0:i.purchases)&&void 0!==a?a:[]})).catch((function(t){e.error=t})).finally((function(){e.loading=!1}))}},created:function(){var e=this;this.fetchPurchases(),this.Get_Shipments(1),Fire.$on("Event_Shipment",(function(){setTimeout((function(){e.Get_Shipments(e.serverParams.page),e.$bvModal.hide("New_Shipment")}),500)})),Fire.$on("Delete_Shipment",(function(){setTimeout((function(){e.Get_Shipments(e.serverParams.page)}),500)}))}};const n=(0,a(14486).A)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-content"},[t("breadcumb",{attrs:{page:e.$t("Shipments"),folder:e.$t("Purchase")}}),e._v(" "),e.isLoading?t("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):e._e(),e._v(" "),e.isLoading?e._e():t("b-card",{staticClass:"wrapper"},[t("vue-good-table",{attrs:{mode:"remote",columns:e.columns,totalRows:e.totalRows,rows:e.purchase_shiments,"search-options":{enabled:!0,placeholder:e.$t("Search_this_table")},"select-options":{enabled:!0,clearSelectionText:""},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"table-hover tableOne vgt-table"},on:{"on-page-change":e.onPageChange,"on-per-page-change":e.onPerPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch},scopedSlots:e._u([{key:"table-row",fn:function(a){return["actions"==a.column.field?t("span",[a.row.tracking_url?[t("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{href:a.row.tracking_url,title:"Visit",target:"_blanck"}},[t("i",{staticClass:"i-Right text-25 text-success"})])]:e._e(),e._v(" "),t("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Edit"},on:{click:function(t){return e.Edit_Shipment(a.row)}}},[t("i",{staticClass:"i-Edit text-25 text-success"})]),e._v(" "),t("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Delete"},on:{click:function(t){return e.Remove_Shipment(a.row.id)}}},[t("i",{staticClass:"i-Close-Window text-25 text-danger"})])],2):"BaseShipment"==a.column.field?t("div",[""!=a.row.date?t("span",[e._v(e._s(a.row.date))]):t("span",[e._v("N/D")])]):"purchase.Ref"==a.column.field?t("div",[t("router-link",{attrs:{to:"/app/purchases/detail/"+a.row.purchase.id}},[t("span",{staticClass:"ul-btn__text ml-1"},[e._v(e._s(a.row.purchase.Ref))])]),e._v(" "),t("br"),e._v(" "),"yes"==a.row.purchase.purchase_has_return?t("small",[t("i",{staticClass:"text-15 text-danger i-Back"})]):e._e()],1):"status"==a.column.field?t("div",["delivered"==a.row.status?t("span",{staticClass:"badge badge-outline-success"},[e._v(e._s(e.$t("Delivered")))]):"intransit"==a.row.status?t("span",{staticClass:"badge badge-outline-info"},[e._v(e._s(e.$t("In Transit")))]):"pending"==a.row.status?t("span",{staticClass:"badge badge-outline-secondary"},[e._v(e._s(e.$t("Pending")))]):t("span",{staticClass:"badge badge-outline-warning"},[e._v(e._s(e.$t(a.row.status)))])]):e._e()]}}],null,!1,1576915878)},[t("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[t("b-button",{staticClass:"btn-rounded",attrs:{variant:"btn btn-primary btn-icon m-1"},on:{click:function(t){return e.New_Shipment()}}},[t("i",{staticClass:"i-Add"}),e._v("\n          "+e._s(e.$t("Add"))+"\n        ")])],1)])],1),e._v(" "),t("validation-observer",{ref:"Create_Shipment"},[t("b-modal",{attrs:{"hide-footer":"",size:"lg",id:"New_Shipment",title:e.editmode?e.$t("Edit"):e.$t("Add")}},[t("b-form",{on:{submit:function(t){return t.preventDefault(),e.Submit_Shipment.apply(null,arguments)}}},[t("b-row",[t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"order_number",rules:{required:!0,max:68}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("OrderNumber")+" *"}},[t("b-form-input",{attrs:{placeholder:e.$t("Enter_Shipment_OrderNumber"),state:e.getValidationState(a),"aria-describedby":"order_number-feedback",label:e.$t("OrderNumber")},model:{value:e.shipment.order_number,callback:function(t){e.$set(e.shipment,"order_number",t)},expression:"shipment.order_number"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"order_number-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"tracking_number",rules:{required:!1,max:68}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("TrackingNumber")+" *"}},[t("b-form-input",{attrs:{placeholder:e.$t("Enter_Shipment_TrackingNumber"),state:e.getValidationState(a),"aria-describedby":"tracking_number-feedback",label:e.$t("TrackingNumber")},model:{value:e.shipment.tracking_number,callback:function(t){e.$set(e.shipment,"tracking_number",t)},expression:"shipment.tracking_number"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"tracking_number-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"date",rules:{required:!0}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("Date")+" *"}},[t("b-form-datepicker",{attrs:{placeholder:e.$t("Enter_Shipment_Date"),state:e.getValidationState(a),"aria-describedby":"date-feedback",label:e.$t("Date"),type:"datetime"},model:{value:e.shipment.date,callback:function(t){e.$set(e.shipment,"date",t)},expression:"shipment.date"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"date-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"expectedArrivalAt",rules:{required:!1}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("ExpectedArrival")}},[t("b-form-datepicker",{attrs:{placeholder:e.$t("Enter_Shipment_Expected_Date"),state:e.getValidationState(a),"aria-describedby":"expectedArrivalAt-feedback",label:e.$t("ExpectedArrival"),type:"datetime"},model:{value:e.shipment.expected_arrival_at,callback:function(t){e.$set(e.shipment,"expected_arrival_at",t)},expression:"shipment.expected_arrival_at"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"expectedArrivalAt-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{attrs:{md:"12"}},[t("validation-provider",{attrs:{name:"description",rules:{required:!1,max:1e3}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("Description")}},[t("b-form-textarea",{attrs:{placeholder:e.$t("Enter_Shipment_Description"),state:e.getValidationState(a),"aria-describedby":"Description-feedback",label:"Description",rows:6,clearable:""},model:{value:e.shipment.description,callback:function(t){e.$set(e.shipment,"description",t)},expression:"shipment.description"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"description-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{staticClass:"mb-3",attrs:{lg:"6",md:"6",sm:"12"}},[t("validation-provider",{attrs:{name:"purchase",rules:{required:!1}},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.valid,s=a.errors;return t("b-form-group",{attrs:{label:e.$t("purchase")+" *"}},[t("v-select",{directives:[{name:"on-r-input",rawName:"v-on-r-input",value:e.Selected_Purchase,expression:"Selected_Purchase"}],class:{"is-invalid":!!s.length},attrs:{state:!s[0]&&(!!i||null),disabled:!e.canSelectPurchase,reduce:function(e){return e.value},placeholder:e.$t("Choose_Purchase"),options:e.purchases.map((function(e){return{label:e.Ref,value:e.id}}))},model:{value:e.shipment.purchase_id,callback:function(t){e.$set(e.shipment,"purchase_id",t)},expression:"shipment.purchase_id"}}),e._v(" "),t("b-form-invalid-feedback",[e._v(e._s(s[0]))])],1)}}])})],1),e._v(" "),t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"tracking_url",rules:{required:!1,max:68}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("TrackingUrl")}},[t("b-form-input",{attrs:{placeholder:e.$t("Enter_Shipment_TrackingUrl"),state:e.getValidationState(a),"aria-describedby":"tracking_url-feedback",label:e.$t("TrackingUrl")},model:{value:e.shipment.tracking_url,callback:function(t){e.$set(e.shipment,"tracking_url",t)},expression:"shipment.tracking_url"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"tracking_url-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{directives:[{name:"show",rawName:"v-show",value:e.show_status,expression:"show_status"}],attrs:{md:"6"}},[t("b-form-group",{attrs:{label:e.$t("Status")}},[t("v-select",{attrs:{reduce:function(e){return e.value},placeholder:e.$t("Choose_Shipment_Status"),options:[{label:"Pending",value:"pending"},{label:"In Transit",value:"intransit"},{label:"Delivered",value:"delivered"},{label:"Cancelled",value:"cancelled"}]},model:{value:e.shipment.status,callback:function(t){e.$set(e.shipment,"status",t)},expression:"shipment.status"}})],1)],1),e._v(" "),t("b-col",{attrs:{md:"6"}},[t("validation-provider",{attrs:{name:"shipping_company_name",rules:{required:!0,max:68}},scopedSlots:e._u([{key:"default",fn:function(a){return[t("b-form-group",{attrs:{label:e.$t("ShippingCompanyName")+" *"}},[t("b-form-input",{attrs:{placeholder:e.$t("Enter_Shipment_ShippingCompanyName"),state:e.getValidationState(a),"aria-describedby":"shipping_company_name-feedback",label:e.$t("ShippingCompanyName")},model:{value:e.shipment.shipping_company_name,callback:function(t){e.$set(e.shipment,"shipping_company_name",t)},expression:"shipment.shipping_company_name"}}),e._v(" "),t("b-form-invalid-feedback",{attrs:{id:"shipping_company_name-feedback"}},[e._v(e._s(a.errors[0]))])],1)]}}])})],1),e._v(" "),t("b-col",{staticClass:"mt-3",attrs:{md:"12"}},[t("b-button",{attrs:{variant:"primary",type:"submit",disabled:e.SubmitProcessing}},[t("i",{staticClass:"i-Yes me-2 font-weight-bold"}),e._v(" "+e._s(e.$t("submit")))]),e._v(" "),e.SubmitProcessing?e._m(0):e._e()],1)],1)],1)],1)],1)],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"typo__p"},[e("div",{staticClass:"spinner sm spinner-primary mt-3"})])}],!1,null,null,null).exports}}]);